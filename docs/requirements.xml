<Requirements>
    <UseCase id="UC-MAP-01" name="Замена блоков дизайнера">
        <Actor>Инженер ЭОМ</Actor>
        <Description>Массовая замена сторонних блоков на блоки из стандарта организации с сохранением данных.</Description>
        <Steps>
            <Step>Инженер вызывает команду EOM_MAP.</Step>
            <Step>Система запрашивает выбор блоков на чертеже.</Step>
            <Step>Для каждого блока система ищет соответствие в Settings.json (по имени).</Step>
            <Step>Система считывает значение атрибута (например, 'ВЫСОТА') из исходного блока.</Step>
            <Step>Система заменяет блок на целевой, сохраняя точку вставки, угол поворота и записывая считанную высоту в новый атрибут.</Step>
        </Steps>
    </UseCase>

    <UseCase id="UC-TRACE-01" name="Трассировка и расчет длины">
        <Actor>Инженер ЭОМ</Actor>
        <Description>Автоматический расчет реальной длины кабеля с учетом вертикальных участков.</Description>
        <Steps>
            <Step>Инженер вызывает команду EOM_TRACE.</Step>
            <Step>Инженер выбирает полилинию (трассу) и два блока (источник и потребитель).</Step>
            <Step>Система нормализует координаты (UCS to WCS).</Step>
            <Step>Система извлекает атрибут 'ВЫСОТА_УСТАНОВКИ' из обоих блоков.</Step>
            <Step>Система вычисляет: L_total = L_2d + ABS(H1 - H2) + запас 5%.</Step>
            <Step>Система записывает результат и марку кабеля в XData полилинии.</Step>
        </Steps>
    </UseCase>

    <UseCase id="UC-SPEC-01" name="Формирование спецификации">
        <Actor>Инженер ЭОМ</Actor>
        <Description>Сбор данных из чертежа и выгрузка в таблицу.</Description>
        <Steps>
            <Step>Инженер вызывает команду EOM_SPEC.</Step>
            <Step>Система сканирует чертеж на наличие XData с ключом 'EOM_DATA'.</Step>
            <Step>Система суммирует длины кабелей по типам и группам.</Step>
            <Step>Система формирует таблицу AutoCAD или CSV-файл для Excel.</Step>
        </Steps>
    </UseCase>
</Requirements>